#!/bin/bash

# exit when any command fails
set -e
set -o pipefail

usage () {
	echo ""
	echo "Try 'backup --help' for more information"
	exit 1
}

# assumes that the veracrypt encrypted volume has been already created 

# where the veracrypt encrypted volume will be mounted
MOUNT_POINT=

# mount the encrypted veracrypt volume


# =====================================
# BACKUP ALGO

# path where the encrypted volume is located
BACKUP_LOCATION=./test/backup

# list of all files and folders in the backup
FILES=(
	"./test/docs"
	"./test/vids"
	"./test/photos"
)

if [ ! -d "$BACKUP_LOCATION" ]; then
	echo "Backup location '"$BACKUP_LOCATION"' does not exist.">&2
	usage
fi

for file in "${FILES[@]}"; do
	if [ ! -d "$file" ]; then
		echo "Files "$file" do not exist.">&2
		usage
	fi
done


# collect and compress the list of files onto the $backup_location/YYYY-MM-dd-HHmmss_backup
backup_filename=".$(date +%F-%H%M%S)_backup"

echo "Full backup started."

tar czvf "$BACKUP_LOCATION"/"$backup_filename".tgz ${FILES[*]}

echo "Full backup completed successfully."


# =====================================

# unmount the veracrypt encrypted volume



